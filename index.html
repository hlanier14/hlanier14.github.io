<html>
    <script src='https://d3js.org/d3.v5.min.js'></script>
    <style> 
        circle {
            fill: lightblue; 
            stroke: black;
        }
        div {
            display: flex;
            margin-left: 4em;
        }
        button {
            height: 2em;
            width: 3em;
            margin-top: 3em;
        }
        svg {
            margin-left: 2em;
        }
    </style>
    <body onload='sceneOne()'>
        <div>
            <button onclick='sceneOne()'>1</button>
            <button onclick='sceneTwo()'>2</button>
            <button onclick='sceneThree()'>3</button>
            <button onclick='sceneFour()'>4</button>
            <svg width=300 height=300></svg>
        </div>
        <script>

            async function framework(fromYear, toYear) {
            
                const data = await d3.csv("https://raw.githubusercontent.com/hlanier14/hlanier14.github.io/main/tuition.csv");
                var width = 600;
                var height = 600;
                var margin = 50;

                const filteredData = data.filter(d => +d["Year"] <= fromYear);
                const transitionData = data.filter(d => +d["Year"] >= fromYear && +d["Year"] <= toYear);

                var x = d3.scaleLinear([1963, 2020], [0,width]);
                var xaxis = d3.axisBottom(x).tickFormat(d3.format("")); 

                var y = d3.scaleLinear([0,18000], [height,0]);
                var yaxis = d3.axisLeft(y).tickFormat(d3.format("$~s")); 

                // clear canvas
                d3.select("svg")
                    .selectAll("*")
                    .remove();

                var svg = d3.select("svg")
                            .attr("width", width + 2 * margin)
                            .attr("height", height + 2 * margin)
                            .append("g")
                            .attr("transform", "translate("+margin+","+margin+")")
                
                var graph = svg.append("path")
                                .datum(filteredData)
                                .attr("fill", "none")
                                .attr("stroke", "steelblue")
                                .attr("stroke-width", 1.5)
                                .attr("d", d3.line()
                                            .x(function(d) { return x(+d["Year"]); })
                                            .y(function(d) { return y(+d["4-Year Tution in 2020 Dollars"]); }))
                
                var transitionGraph = svg.append("path")
                                        .datum(transitionData)
                                        .attr("fill", "none")
                                        .attr("stroke", "steelblue")
                                        .attr("stroke-width", 1.5)
                                        .attr("d", d3.line()
                                                    .x(function(d) { return x(+d["Year"]); })
                                                    .y(function(d) { return y(+d["4-Year Tution in 2020 Dollars"]); }))
                
                var totalLength = transitionGraph.node().getTotalLength();

                transitionGraph.attr("stroke-dasharray", totalLength + " " + totalLength)
                                .attr("stroke-dashoffset", totalLength)
                                .transition()
                                .duration(1500)
                                .ease(d3.easeLinear)
                                .attr("stroke-dashoffset", 0);

                svg.append("g")
                    .attr("transform", "translate(0,"+height+")")
                    .call(xaxis);

                svg.append("g")
                    .call(yaxis);
            }
            async function sceneOne() {
                var fromYear = 1963;
                var toYear = 1980;
                await framework(fromYear, toYear);
            }
            async function sceneTwo() {
                var fromYear = 1980;
                var toYear = 2000;
                await framework(fromYear, toYear);
            }
            async function sceneThree() {
                var fromYear = 2000;
                var toYear = 2010;
                await framework(fromYear, toYear);
            }
            async function sceneFour() {
                var fromYear = 2010;
                var toYear = 2020;
                await framework(fromYear, toYear);
            }
        </script>
    </body>
</html>